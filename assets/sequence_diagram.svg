<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 929.75 2962" width="929.75" height="2962" style="--bg:#FFFFFF;--fg:#27272A;background:var(--bg)">
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap');
  text { font-family: 'Inter', system-ui, sans-serif; }
  svg {
    /* Derived from --bg and --fg (overridable via --line, --accent, etc.) */
    --_text:          var(--fg);
    --_text-sec:      var(--muted, color-mix(in srgb, var(--fg) 60%, var(--bg)));
    --_text-muted:    var(--muted, color-mix(in srgb, var(--fg) 40%, var(--bg)));
    --_text-faint:    color-mix(in srgb, var(--fg) 25%, var(--bg));
    --_line:          var(--line, color-mix(in srgb, var(--fg) 30%, var(--bg)));
    --_arrow:         var(--accent, color-mix(in srgb, var(--fg) 50%, var(--bg)));
    --_node-fill:     var(--surface, color-mix(in srgb, var(--fg) 3%, var(--bg)));
    --_node-stroke:   var(--border, color-mix(in srgb, var(--fg) 20%, var(--bg)));
    --_group-fill:    var(--bg);
    --_group-hdr:     color-mix(in srgb, var(--fg) 5%, var(--bg));
    --_inner-stroke:  color-mix(in srgb, var(--fg) 12%, var(--bg));
    --_key-badge:     color-mix(in srgb, var(--fg) 10%, var(--bg));
  }
</style>
<defs>
  <marker id="seq-arrow" markerWidth="8" markerHeight="4.8" refX="8" refY="2.4" orient="auto-start-reverse">
    <polygon points="0 0, 8 2.4, 0 4.8" fill="var(--_arrow)" />
  </marker>
  <marker id="seq-arrow-open" markerWidth="8" markerHeight="4.8" refX="8" refY="2.4" orient="auto-start-reverse">
    <polyline points="0 0, 8 2.4, 0 4.8" fill="none" stroke="var(--_arrow)" stroke-width="1" />
  </marker>
</defs>
<rect x="30" y="78" width="432.02500000000003" height="430" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="30" y="78" width="156.35999999999999" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="36" y="87" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">rect [rgb(45, 50, 80)]</text>
<rect x="30" y="844" width="711.95" height="384" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="30" y="844" width="194.64" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="36" y="853" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">alt [Authentication Success]</text>
<line x1="30" y1="1110" x2="741.95" y2="1110" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<text x="38" y="1124" font-size="11" font-weight="400" fill="var(--_text-muted)">[Authentication Failed]</text>
<rect x="30" y="546" width="711.95" height="682" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="30" y="546" width="156.35999999999999" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="36" y="555" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">rect [rgb(80, 50, 50)]</text>
<rect x="309.925" y="1732" width="589.825" height="140" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="309.925" y="1732" width="201.01999999999998" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="315.925" y="1741" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">opt [File Content Operations]</text>
<rect x="309.925" y="1584" width="589.825" height="860" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="309.925" y="1584" width="507.26" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="315.925" y="1593" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">alt [File Operations (ls, cd, mkdir, touch, cat, echo, mv, delete, cp, find)]</text>
<line x1="309.925" y1="1880" x2="899.75" y2="1880" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<text x="317.925" y="1894" font-size="11" font-weight="400" fill="var(--_text-muted)">[Permission Operations (chmod, chown, chgrp)]</text>
<line x1="309.925" y1="2054" x2="899.75" y2="2054" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<text x="317.925" y="2068" font-size="11" font-weight="400" fill="var(--_text-muted)">[Admin Operations (newuser, newgroup, lsusers, lsgroups)]</text>
<line x1="309.925" y1="2246" x2="899.75" y2="2246" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<text x="317.925" y="2260" font-size="11" font-weight="400" fill="var(--_text-muted)">[Integrity Check (scan)]</text>
<rect x="30" y="1236" width="869.75" height="1428" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="30" y="1236" width="181.88" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="36" y="1245" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">loop [Interactive Session]</text>
<rect x="30" y="1236" width="869.75" height="1428" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="30" y="1236" width="156.35999999999999" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="36" y="1245" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">rect [rgb(50, 80, 50)]</text>
<rect x="30" y="2702" width="432.02500000000003" height="210" rx="0" ry="0" fill="none" stroke="var(--_node-stroke)" stroke-width="1" />
<rect x="30" y="2702" width="156.35999999999999" height="18" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="36" y="2711" dy="0.35em" font-size="11" font-weight="600" fill="var(--_text-sec)">rect [rgb(60, 60, 80)]</text>
<line x1="91.75" y1="70" x2="91.75" y2="2932" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="231.75" y1="70" x2="231.75" y2="2932" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="385.975" y1="70" x2="385.975" y2="2932" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="540.2" y1="70" x2="540.2" y2="2932" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="680.2" y1="70" x2="680.2" y2="2932" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="830.85" y1="70" x2="830.85" y2="2932" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" />
<line x1="91.75" y1="118" x2="231.75" y2="118" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="161.75" y="112" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">connect_async(ws://server:8080)</text>
<line x1="231.75" y1="158" x2="91.75" y2="158" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="161.75" y="152" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">WebSocket Connected</text>
<polyline points="91.75,198 121.75,198 121.75,218 91.75,218" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="127.75" y="208" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Generate X25519 keypair</text>
<line x1="91.75" y1="268" x2="385.975" y2="268" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="262" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">KeyExchangeInit(client_public_key)</text>
<polyline points="385.975,308 415.975,308 415.975,328 385.975,328" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="318" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Generate X25519 keypair</text>
<polyline points="385.975,378 415.975,378 415.975,398 385.975,398" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="388" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Compute shared_secret = DH(server_secret, client_public)</text>
<line x1="385.975" y1="448" x2="91.75" y2="448" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="442" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">KeyExchangeResponse(server_public_key)</text>
<polyline points="91.75,488 121.75,488 121.75,508 91.75,508" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="127.75" y="498" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Compute shared_secret = DH(client_secret, server_public)</text>
<line x1="91.75" y1="586" x2="385.975" y2="586" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="580" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Login(username, password) [encrypted]</text>
<line x1="385.975" y1="626" x2="540.2" y2="626" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="620" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">auth_user(username, password)</text>
<line x1="540.2" y1="666" x2="680.2" y2="666" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="610.2" y="660" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">SELECT salt FROM users WHERE user_name=$1</text>
<line x1="680.2" y1="706" x2="540.2" y2="706" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="610.2" y="700" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Argon2 hash</text>
<polyline points="540.2,746 570.2,746 570.2,766 540.2,766" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="576.2" y="756" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Argon2 verify(password, hash)</text>
<line x1="540.2" y1="816" x2="385.975" y2="816" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="810" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">auth result (bool)</text>
<line x1="385.975" y1="884" x2="540.2" y2="884" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="878" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">get_user(username)</text>
<line x1="540.2" y1="924" x2="680.2" y2="924" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="610.2" y="918" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">SELECT user details</text>
<line x1="680.2" y1="964" x2="540.2" y2="964" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="610.2" y="958" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">User record</text>
<polyline points="385.975,1004 415.975,1004 415.975,1024 385.975,1024" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="1014" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Set authenticated=true, current_user, current_path</text>
<line x1="385.975" y1="1074" x2="91.75" y2="1074" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="1068" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Login OK (is_admin) [encrypted]</text>
<polyline points="385.975,1138 415.975,1138 415.975,1158 385.975,1158" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="1148" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Increment failed_login_attempts</text>
<line x1="385.975" y1="1208" x2="91.75" y2="1208" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="1202" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Failure(error) [encrypted]</text>
<polyline points="91.75,1276 121.75,1276 121.75,1296 91.75,1296" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="127.75" y="1286" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">readline() - get user input</text>
<polyline points="91.75,1346 121.75,1346 121.75,1366 91.75,1366" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="127.75" y="1356" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">command_parser(input) -&gt; AppMessage</text>
<line x1="91.75" y1="1416" x2="385.975" y2="1416" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="1410" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Command(args) [AES-256-GCM encrypted]</text>
<polyline points="385.975,1456 415.975,1456 415.975,1476 385.975,1476" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="1466" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">decrypt_app_message()</text>
<polyline points="385.975,1526 415.975,1526 415.975,1546 385.975,1546" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="1536" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Check authentication &amp; permissions</text>
<line x1="385.975" y1="1624" x2="540.2" y2="1624" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="1618" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">get_f_node() / add_file() / update_path()</text>
<line x1="540.2" y1="1664" x2="680.2" y2="1664" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="610.2" y="1658" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Encrypted query (pgcrypto)</text>
<line x1="680.2" y1="1704" x2="540.2" y2="1704" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="610.2" y="1698" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Result</text>
<line x1="385.975" y1="1772" x2="830.85" y2="1772" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="608.4125" y="1766" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">read/write file content</text>
<line x1="830.85" y1="1812" x2="385.975" y2="1812" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="608.4125" y="1806" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">content/status</text>
<line x1="385.975" y1="1852" x2="540.2" y2="1852" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="1846" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">update_hash() with BLAKE3</text>
<polyline points="385.975,1916 415.975,1916 415.975,1936 385.975,1936" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="1926" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Verify ownership</text>
<line x1="385.975" y1="1986" x2="540.2" y2="1986" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="1980" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">change_file_perms() / change_owner()</text>
<line x1="540.2" y1="2026" x2="680.2" y2="2026" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="610.2" y="2020" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">UPDATE fnode SET...</text>
<line x1="385.975" y1="2090" x2="540.2" y2="2090" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="2084" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">is_admin(current_user)</text>
<line x1="540.2" y1="2130" x2="680.2" y2="2130" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="610.2" y="2124" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">SELECT is_admin</text>
<line x1="385.975" y1="2170" x2="540.2" y2="2170" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="2164" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">create_user() / create_group() / get_all_users()</text>
<line x1="540.2" y1="2210" x2="680.2" y2="2210" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="610.2" y="2204" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">INSERT/SELECT</text>
<line x1="385.975" y1="2274" x2="830.85" y2="2274" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="608.4125" y="2268" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Read file content</text>
<polyline points="385.975,2314 415.975,2314 415.975,2334 385.975,2334" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="2324" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">hash_content() with BLAKE3</text>
<line x1="385.975" y1="2384" x2="540.2" y2="2384" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="2378" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">get_f_node() - retrieve stored hash</text>
<polyline points="385.975,2424 415.975,2424 415.975,2444 385.975,2444" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="2434" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Compare hashes</text>
<line x1="540.2" y1="2494" x2="385.975" y2="2494" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="463.08750000000003" y="2488" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Operation result</text>
<polyline points="385.975,2534 415.975,2534 415.975,2554 385.975,2554" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="2544" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">encrypt_app_message()</text>
<line x1="385.975" y1="2604" x2="91.75" y2="2604" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="2598" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Response [encrypted]</text>
<polyline points="91.75,2644 121.75,2644 121.75,2664 91.75,2664" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="127.75" y="2654" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Display result to user</text>
<line x1="91.75" y1="2742" x2="385.975" y2="2742" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="2736" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Logout [encrypted]</text>
<polyline points="385.975,2782 415.975,2782 415.975,2802 385.975,2802" fill="none" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="421.975" y="2792" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">authenticated=false, clear session</text>
<line x1="385.975" y1="2852" x2="91.75" y2="2852" stroke="var(--_line)" stroke-width="0.75" stroke-dasharray="6 4" marker-end="url(#seq-arrow)" />
<text x="238.8625" y="2846" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Logout OK</text>
<line x1="91.75" y1="2892" x2="231.75" y2="2892" stroke="var(--_line)" stroke-width="0.75" marker-end="url(#seq-arrow)" />
<text x="161.75" y="2886" text-anchor="middle" font-size="11" font-weight="400" fill="var(--_text-muted)">Close connection</text>
<rect x="133.6225" y="74" width="210.48000000000002" height="27" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<polygon points="338.1025,74 344.1025,80 338.1025,80" fill="var(--_inner-stroke)" />
<text x="238.8625" y="87.5" text-anchor="middle" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Phase 1: Connection &amp; Key Exchange</text>
<rect x="142.20250000000001" y="492" width="193.32" height="27" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<polygon points="329.52250000000004,492 335.52250000000004,498 329.52250000000004,498" fill="var(--_inner-stroke)" />
<text x="238.8625" y="505.5" text-anchor="middle" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">AES-256-GCM session established</text>
<rect x="312.19500000000005" y="492" width="147.56" height="27" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<polygon points="453.75500000000005,492 459.75500000000005,498 453.75500000000005,498" fill="var(--_inner-stroke)" />
<text x="385.975" y="505.5" text-anchor="middle" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Phase 2: Authentication</text>
<rect x="364.64" y="1212" width="193.32" height="27" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<polygon points="551.96,1212 557.96,1218 551.96,1218" fill="var(--_inner-stroke)" />
<text x="461.29999999999995" y="1225.5" text-anchor="middle" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Phase 3: Command Execution Loop</text>
<rect x="150.78250000000003" y="2648" width="176.16" height="27" fill="var(--_group-hdr)" stroke="var(--_node-stroke)" stroke-width="0.75" />
<polygon points="320.9425,2648 326.9425,2654 320.9425,2654" fill="var(--_inner-stroke)" />
<text x="238.8625" y="2661.5" text-anchor="middle" dy="0.35em" font-size="11" font-weight="400" fill="var(--_text-muted)">Phase 4: Session Termination</text>
<rect x="40" y="30" width="103.5" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="91.75" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">Client CLI</text>
<rect x="183.575" y="30" width="96.35000000000001" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="231.75" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">WebSocket</text>
<rect x="319.925" y="30" width="132.10000000000002" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="385.975" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">Server Handler</text>
<rect x="492.02500000000003" y="30" width="96.35000000000001" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="540.2" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">DAO Layer</text>
<rect x="628.45" y="30" width="103.5" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="680.2" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">PostgreSQL</text>
<rect x="771.95" y="30" width="117.80000000000001" height="40" rx="4" ry="4" fill="var(--_node-fill)" stroke="var(--_node-stroke)" stroke-width="1" />
<text x="830.85" y="50" text-anchor="middle" dy="0.35em" font-size="13" font-weight="500" fill="var(--_text)">File Storage</text>
</svg>